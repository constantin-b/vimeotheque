function CFVim_receiveMessage(e){if(-1!=e.origin.indexOf("vimeo")&&"object"!=typeof e.data){var i=jQuery.parseJSON(e.data),t=i.player_id;if(void 0!==t)switch(i.event){case"ready":var a=jQuery(t.replace("CFVimVideoPlayer","#CFVim_videoPlayerContainer_"));jQuery(a).data("ref").updateStatus(1),CFVim_post_action("addEventListener","pause",t),CFVim_post_action("addEventListener","finish",t),CFVim_post_action("addEventListener","play",t);break;case"play":a=jQuery(t.replace("CFVimVideoPlayer","#CFVim_videoPlayerContainer_"));jQuery(a).data("ref").updateStatus(2);break;case"pause":a=jQuery(t.replace("CFVimVideoPlayer","#CFVim_videoPlayerContainer_"));jQuery(a).data("ref").updateStatus(3);break;case"finish":a=jQuery(t.replace("CFVimVideoPlayer","#CFVim_videoPlayerContainer_"));jQuery(a).data("ref").updateStatus(4)}}}function CFVim_post_action(e,i,t){var a={method:e};void 0!==i&&(a.value=i);var o=jQuery("#"+t)[0];o.contentWindow.postMessage(JSON.stringify(a),jQuery(o).attr("src").split("?")[0])}!function(f){f.fn.Vimeo_VideoPlayer=function(s){if(0==this.length)return!1;if(!(1<this.length)){var e,i,l=this,d=(s=f.extend({},{width:500,height:375,play:0,volume:30,loop:0,autoplay:0,noWinResize:!1,stateChange:function(){}},s),!1),o=!1,u=!1,c=!1,p=!1,t=function(e,i){cvm_resize_player(l)},a=function(){var e=f(l).data();return e.size_ratio=parseFloat(e.size_ratio),e},r=function(){var e={api:1,title:0,byline:0,portrait:0,color:"",player_id:d,clip_id:s.video_id||c.video_id};return f.extend({},s,e,c)},n=function(){var e=Math.floor(1e3*Math.random()),i={};return i.cid="CFVim_videoPlayerContainer_"+e,i.pid="CFVimVideoPlayer"+e,i},v=function(){_(s.clip_id)},_=function(e){var i={api:1,autopause:1,autoplay:s.autoplay,title:s.title,byline:s.byline,portrait:s.portrait,loop:s.loop,color:s.color,player_id:d},t="https://player.vimeo.com/video/"+e+"?"+f.param(i),a='<iframe style="visibility:visible;" id="'+d+'" src="'+t+'" width="100%" height="100%" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';f("#"+o).empty().append(a),m("load"),this.isHTML5||(this.isHTML5=!0)},m=function(e,i){if(this.isHTML5&&"loadVideo"==e)return m("pause"),_(i),void(p=!1);if(p){p=1;var t={play:"api_play",pause:"api_pause",stop:"api_stop",volume:"api_setVolume",loadVideo:"api_loadVideo",unload:"api_unload",volumeDivider:100};if(!u){u=document.getElementById(d);var a=t.volume,o=0==c.volume?0:(c.volume||10)/t.volumeDivider;this.isHTML5?CFVim_post_action(a.replace("api_",""),o,d):u[a](o)}if("volume"==e&&(i/=t.volumeDivider),"load"!=e){var r=t[e];if(this.isHTML5){var n=void 0!==i?i:"";CFVim_post_action(r.replace("api_",""),n,d)}else"loadVideo"==e&&(p=!1),void 0!==i?u[r](i):u[r]();switch(e){case"play":p=2;break;case"pause":p=3;break;case"stop":p=4}s.stateChange.call(l,p)}}else setTimeout(function(){m(e,i)},100)};return this.play=function(){m("play")},this.pause=function(){m("pause")},this.stop=function(){m("stop")},this.load=function(e){m("loadVideo",e)},this.setVolume=function(e){m("volume",e)},this.getData=function(){return c},this.getStatus=function(){return p},this.updateStatus=function(e){p=e,s.stateChange.call(l,e)},this.resize=function(e,i){t(e,i)},f(this).data("ref",this),e=a(),i=n(),f(l).attr("id",i.cid).empty().append('<div id="'+i.pid+'"></div>'),o=i.cid,d=i.pid,c=e,(s=r("vimeo")).source="vimeo",v(),t(s.aspect_ratio,s.size_ratio),s.noWinResize||f(window).resize(function(){t(s.aspect_ratio,s.size_ratio)}),l}this.each(function(){f(this).Vimeo_VideoPlayer(s)})}}(jQuery),window.addEventListener?window.addEventListener("message",CFVim_receiveMessage,!1):window.attachEvent("onmessage",CFVim_receiveMessage,!1),function(o){o(window).on("load",function(){o('div[class^="cvm_single_video_player"]:not(.cvm_simple_embed)').Vimeo_VideoPlayer({elem_data:!0})}),o(document).ready(function(){o("div.cvm_single_video_player.cvm_simple_embed").each(function(){var e=this;cvm_resize_player(this),o(window).resize(function(){cvm_resize_player(e)})})}),window.cvm_resize_player=function(e){var i,t=o(e).data(),a=o(e).width();if(t.size_ratio=parseFloat(t.size_ratio),0<t.size_ratio)i=Math.floor(a/t.size_ratio);else switch(t.aspect_ratio){case"16x9":default:i=Math.floor(9*a/16);break;case"4x3":i=Math.floor(3*a/4);break;case"2.35x1":i=Math.floor(a/2.35)}o(e).css({height:i})}}(jQuery),function(p){p.fn.CVM_Player_Default=function(o){if(0==this.length)return!1;if(!(1<this.length)){o=p.extend({},{player:".cvm-player",items:".cvm-playlist-item a",attr:"rel",loadVideo:function(){}},o);var r=this,n=p(this).find(o.player),s=!1,l=p(this).find(o.items),d=!1;currentItem=0;var u=function(e){if(4===e&&1==d.playlist_loop&&currentItem<l.length-1){currentItem++;var i=l[currentItem];p(i).trigger("click")}},c=function(){return/webOS|iPhone|iPad|iPod/i.test(navigator.userAgent)};return d=p(n).data(),p.each(l,function(i,e){var t=p(this).data();if(p(this).data("video_data",t),0==i){var a=d;a.video_id=t.video_id,a.volume=t.volume,a.stateChange=u,a.noWinResize=!0,(s=p(n).Vimeo_VideoPlayer(a)).resize(t.aspect_ratio,t.size_ratio),"1"!=t.autoplay||c()||s.play(),currentItem=0,o.loadVideo.call(r,currentItem),p(this).addClass("active-video")}p(this).click(function(e){p(l).removeClass("active-video"),p(this).addClass("active-video"),e.preventDefault(),s.load(t.video_id),s.setVolume(t.volume),s.resize(t.aspect_ratio,t.size_ratio),"1"!=t.autoplay&&1!=d.playlist_loop||c()||s.play(),currentItem=i,o.loadVideo.call(r,currentItem)})}),p(window).resize(function(){var e=p(l[currentItem]).data();s.resize(e.aspect_ratio,e.size_ratio)}),r}this.each(function(){p(this).CVM_Player_Default(o)})}}(jQuery);